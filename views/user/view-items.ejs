<!DOCTYPE html>
<html lang="en">

<head>
	<%- include("../baselinks") -%>
</head>

<body>
	<%- include("../header") -%>
	<div class="container">
		<h2>Search for items to add to your cart</h2>
		<form action="/items/search" method="post">
			<div class="form-group">
				<div class="row">
				<div class="input-group col-sm-6">
					<input type="text" class="form-control" name="name" placeholder="Search by item name" aria-label="Item Name" aria-describedby="button-name">
					<div class="input-group-append">
						<button class="btn btn-outline-secondary btn-md form-control" type="action" value="Confirm">Search</button>
					</div>
				</div>
				<div class="input-group col-sm-6">
					<input type="number" class="form-control" name="barcode" placeholder="Search by barcode" aria-label="Item Code" aria-describedby="button-code">
					<div class="input-group-append">
					<button class="btn btn-outline-secondary btn-md form-control" type="action" value="Confirm">Search</button>
					</div>
				</div>
				</div>
			</div>
		</form>
		<div class="table-responsive">
			<table class="table">
				<thead class="thead-light">
					<tr>
						<th scope="col">Item Name</th>
						<th scope="col">Barcode</th>
						<th scope="col">Count</th>
						<th scope="col">Description</th>
						<th scope="col"></th>
					</tr>
				</thead>
				<tbody>
					<% if (response && response.items) {%>
					<% response.items.forEach((item) => {%>
					<tr>
						<th scope="row"><%= item.name%></th>
						<td><%= item.barcode%></td>
						<td><%= item.count%></td>
						<td><%= item.description%></td>
						<td class="text-right pr-1">
							<div class="btn-group" role="group">
								<button type="button" class="btn btn-success" data-toggle="modal" 
									data-target="#reserveModal" data-id="<%= item.id %>" data-name="<%= item.name %>" 
									data-barcode="<%= item.barcode %>" data-count="<%= item.count %>">Reserve Item</button>
							</div>
						</td>
					</tr>
					<% }); %>
					<% } %>
				</tbody>
			</table>
		</div>
		<% if (response && response.error) {%>
		<div class="alert alert-danger">
			<%= response.error%>
		</div>
		<% } %>
	</div>
	<div class="modal fade" id="reserveModal" tabindex="-1" role="dialog" aria-labelledby="reserveModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="reserveModalLabel">Request a hold</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<form name="reserveForm" id="reserveForm" action="/items/add" method="POST">
						<div class="form-group">
							<input class="form-control" type="text" name="id" id="reserveModalId" readonly hidden>
						</div>
						<div class="form-group">
							<label for="reserveModalName">Item Name</label>
							<input class="form-control" type="text" name="name" id="reserveModalName" placeholder="Item Name" readonly>
						</div>
						<div class="form-group">
							<label for="reserveModalBarcode">Barcode</label>
							<input class="form-control" type="text" name="barcode" id="reserveModalBarcode" placeholder="Barcode" readonly>
						</div>
						<div class="form-group">
							<label for="reserveModalQuantity">Quantity to reserve</label>
							<input class="form-control" type="number" name="quantity" id="reserveModalQuantity" min="1">
						</div>
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary" id="submitreserve">Submit</button>
					</form>
				</div>
			</div>
		</div>
  	</div>
	<%- include("../scripts") -%>
	<script src="/static/js/view-items.js"></script>
</body>

</html>